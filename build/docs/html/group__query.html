<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Ripples: DNS Query</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Ripples<span id="projectnumber">&#160;1.0</span>
   </div>
   <div id="projectbrief">High Performant Software Architecture For Transaction Processing</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('group__query.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">DNS Query</div></div>
</div><!--header-->
<div class="contents">
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>DNS query is composed of a DNS request (question) and response (answer). This application only handles DNS query type "question", and provides a simple response. Implementation of DNS records database (zones) is not done as that is beyond the scope of purpose for this project. </p>
<p>Parsing EDNS opt RR is supported along with EDNS client subnet extension.</p>
<p>A single structure is used to hold query request and query response. Depending if query arrived over UDP or TCP, appropriate buffers are made available providing access to raw query data (as received or to be sent over the network). </p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structedns__client__subnet__s.html">edns_client_subnet_s</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structedns__s.html">edns_s</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structquery__s.html">query_s</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structquery__log__s.html">query_log_s</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structquery__log__loop__args__s.html">query_log_loop_args_s</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structrr__record__s.html">rr_record_s</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="typedef-members" name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:ga3ca6aa22eb1e7c2bbc1eaa142d1041a8" id="r_ga3ca6aa22eb1e7c2bbc1eaa142d1041a8"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structedns__client__subnet__s.html">edns_client_subnet_s</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__query.html#ga3ca6aa22eb1e7c2bbc1eaa142d1041a8">edns_client_subnet_t</a></td></tr>
<tr class="separator:ga3ca6aa22eb1e7c2bbc1eaa142d1041a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaeea966773633cbfc80d6a6c47e506d32" id="r_gaeea966773633cbfc80d6a6c47e506d32"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structedns__s.html">edns_s</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__query.html#gaeea966773633cbfc80d6a6c47e506d32">edns_t</a></td></tr>
<tr class="separator:gaeea966773633cbfc80d6a6c47e506d32"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga99fac2995915676a917f68a08bb7f007" id="r_ga99fac2995915676a917f68a08bb7f007"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structquery__s.html">query_s</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__query.html#ga99fac2995915676a917f68a08bb7f007">query_t</a></td></tr>
<tr class="separator:ga99fac2995915676a917f68a08bb7f007"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad71a97c752a76493cd34482f1a8cbd0c" id="r_gad71a97c752a76493cd34482f1a8cbd0c"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structquery__log__s.html">query_log_s</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__query.html#gad71a97c752a76493cd34482f1a8cbd0c">query_log_t</a></td></tr>
<tr class="separator:gad71a97c752a76493cd34482f1a8cbd0c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7e8eca656f657c57c3fb58c1d916fa18" id="r_ga7e8eca656f657c57c3fb58c1d916fa18"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structquery__log__loop__args__s.html">query_log_loop_args_s</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__query.html#ga7e8eca656f657c57c3fb58c1d916fa18">query_log_loop_args_t</a></td></tr>
<tr class="separator:ga7e8eca656f657c57c3fb58c1d916fa18"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa387be0f34555d2245e2bb0377efe9b0" id="r_gaa387be0f34555d2245e2bb0377efe9b0"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structrr__record__s.html">rr_record_s</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__query.html#gaa387be0f34555d2245e2bb0377efe9b0">rr_record_t</a></td></tr>
<tr class="separator:gaa387be0f34555d2245e2bb0377efe9b0"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:gaf02c91b2cf24240c2a4e9e6c82fd1ee8" id="r_gaf02c91b2cf24240c2a4e9e6c82fd1ee8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__query.html#gaf02c91b2cf24240c2a4e9e6c82fd1ee8">query_init</a> (<a class="el" href="group__query.html#ga99fac2995915676a917f68a08bb7f007">query_t</a> *q, <a class="el" href="group__config.html#ga774ff96b58a051085872c40050a75a73">config_t</a> *cfg, uint8_t protocol)</td></tr>
<tr class="separator:gaf02c91b2cf24240c2a4e9e6c82fd1ee8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga779a2cedc67edf2bc0f83f5a886a57d8" id="r_ga779a2cedc67edf2bc0f83f5a886a57d8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__query.html#ga779a2cedc67edf2bc0f83f5a886a57d8">query_reset</a> (<a class="el" href="group__query.html#ga99fac2995915676a917f68a08bb7f007">query_t</a> *q)</td></tr>
<tr class="separator:ga779a2cedc67edf2bc0f83f5a886a57d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf93a1e779559c3be79eea93c16a04f7b" id="r_gaf93a1e779559c3be79eea93c16a04f7b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__query.html#gaf93a1e779559c3be79eea93c16a04f7b">query_clean</a> (<a class="el" href="group__query.html#ga99fac2995915676a917f68a08bb7f007">query_t</a> *q)</td></tr>
<tr class="separator:gaf93a1e779559c3be79eea93c16a04f7b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4a05dc10da1dae3d26c01b40f1a6cf64" id="r_ga4a05dc10da1dae3d26c01b40f1a6cf64"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__query.html#ga4a05dc10da1dae3d26c01b40f1a6cf64">query_tcp_response_buffer_increase</a> (<a class="el" href="group__query.html#ga99fac2995915676a917f68a08bb7f007">query_t</a> *q)</td></tr>
<tr class="separator:ga4a05dc10da1dae3d26c01b40f1a6cf64"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga49ccb0e164ee4f981443c01bda0b7224" id="r_ga49ccb0e164ee4f981443c01bda0b7224"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__query.html#ga49ccb0e164ee4f981443c01bda0b7224">query_parse_edns_ext_cs</a> (<a class="el" href="group__query.html#ga3ca6aa22eb1e7c2bbc1eaa142d1041a8">edns_client_subnet_t</a> *cs)</td></tr>
<tr class="separator:ga49ccb0e164ee4f981443c01bda0b7224"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaecf6360b330f2f7a882b4d0eca5d6da3" id="r_gaecf6360b330f2f7a882b4d0eca5d6da3"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__query.html#gaecf6360b330f2f7a882b4d0eca5d6da3">query_parse_edns_ext</a> (<a class="el" href="group__query.html#ga99fac2995915676a917f68a08bb7f007">query_t</a> *q, unsigned char *buf, unsigned char *eobuf)</td></tr>
<tr class="separator:gaecf6360b330f2f7a882b4d0eca5d6da3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4387ff7b5e07e5b8249928c0bb1ac35b" id="r_ga4387ff7b5e07e5b8249928c0bb1ac35b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__query.html#ga4387ff7b5e07e5b8249928c0bb1ac35b">query_parse_request_rr_additional_edns</a> (<a class="el" href="group__query.html#ga99fac2995915676a917f68a08bb7f007">query_t</a> *q, unsigned char *ptr)</td></tr>
<tr class="separator:ga4387ff7b5e07e5b8249928c0bb1ac35b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga0df26d3c47404b5de3f17d9b3d2a8468" id="r_ga0df26d3c47404b5de3f17d9b3d2a8468"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__query.html#ga0df26d3c47404b5de3f17d9b3d2a8468">query_parse_request_rr_question</a> (<a class="el" href="group__query.html#ga99fac2995915676a917f68a08bb7f007">query_t</a> *q)</td></tr>
<tr class="separator:ga0df26d3c47404b5de3f17d9b3d2a8468"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa6dc55685778db382330d1e4ef70d3df" id="r_gaa6dc55685778db382330d1e4ef70d3df"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__query.html#gaa6dc55685778db382330d1e4ef70d3df">query_parse</a> (<a class="el" href="group__query.html#ga99fac2995915676a917f68a08bb7f007">query_t</a> *q)</td></tr>
<tr class="separator:gaa6dc55685778db382330d1e4ef70d3df"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga2170756867aab87d1d17a0c8388ae533" id="r_ga2170756867aab87d1d17a0c8388ae533"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__query.html#ga2170756867aab87d1d17a0c8388ae533">query_resolve</a> (<a class="el" href="group__query.html#ga99fac2995915676a917f68a08bb7f007">query_t</a> *q)</td></tr>
<tr class="separator:ga2170756867aab87d1d17a0c8388ae533"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gadebe69962416277a46fe9908ceb29269" id="r_gadebe69962416277a46fe9908ceb29269"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__query.html#gadebe69962416277a46fe9908ceb29269">query_pack_edns</a> (uint8_t *buf, uint16_t buf_len, <a class="el" href="group__query.html#gaeea966773633cbfc80d6a6c47e506d32">edns_t</a> *edns)</td></tr>
<tr class="separator:gadebe69962416277a46fe9908ceb29269"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3e057ac872e708a9a49729628ca09051" id="r_ga3e057ac872e708a9a49729628ca09051"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__query.html#ga3e057ac872e708a9a49729628ca09051">query_pack_rr</a> (const unsigned char *name, <a class="el" href="group__query.html#gaa387be0f34555d2245e2bb0377efe9b0">rr_record_t</a> *rr, unsigned char *buf, uint16_t buf_len, const unsigned char **dnptrs, const unsigned char **lastdnptr)</td></tr>
<tr class="separator:ga3e057ac872e708a9a49729628ca09051"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac374ae1c30bca42b0cbd283a584c97eb" id="r_gac374ae1c30bca42b0cbd283a584c97eb"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__query.html#gac374ae1c30bca42b0cbd283a584c97eb">query_response_pack</a> (<a class="el" href="group__query.html#ga99fac2995915676a917f68a08bb7f007">query_t</a> *q)</td></tr>
<tr class="separator:gac374ae1c30bca42b0cbd283a584c97eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gadc83ee2842f0e028220d0bfc21fe2a29" id="r_gadc83ee2842f0e028220d0bfc21fe2a29"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__query.html#gadc83ee2842f0e028220d0bfc21fe2a29">query_log</a> (char *buf, size_t buf_len, <a class="el" href="group__query.html#ga99fac2995915676a917f68a08bb7f007">query_t</a> *q)</td></tr>
<tr class="separator:gadc83ee2842f0e028220d0bfc21fe2a29"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7dc1c1717d6768694ec783ef8d796c8e" id="r_ga7dc1c1717d6768694ec783ef8d796c8e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__query.html#ga7dc1c1717d6768694ec783ef8d796c8e">query_log_rotate</a> (<a class="el" href="group__query.html#gad71a97c752a76493cd34482f1a8cbd0c">query_log_t</a> *<a class="el" href="group__query.html#gadc83ee2842f0e028220d0bfc21fe2a29">query_log</a>)</td></tr>
<tr class="separator:ga7dc1c1717d6768694ec783ef8d796c8e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaaa3817325960b140b4ee9e6d2e1851c0" id="r_gaaa3817325960b140b4ee9e6d2e1851c0"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__query.html#gaaa3817325960b140b4ee9e6d2e1851c0">query_log_loop</a> (void *args)</td></tr>
<tr class="separator:gaaa3817325960b140b4ee9e6d2e1851c0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf0d829123d710a8c6890084265f714e7" id="r_gaf0d829123d710a8c6890084265f714e7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__query.html#gaf0d829123d710a8c6890084265f714e7">query_report_metrics</a> (<a class="el" href="group__query.html#ga99fac2995915676a917f68a08bb7f007">query_t</a> *, <a class="el" href="group__metrics.html#ga343740345b0738f55592031789b23ac8">metrics_t</a> *metrics)</td></tr>
<tr class="separator:gaf0d829123d710a8c6890084265f714e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Typedef Documentation</h2>
<a id="ga3ca6aa22eb1e7c2bbc1eaa142d1041a8" name="ga3ca6aa22eb1e7c2bbc1eaa142d1041a8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga3ca6aa22eb1e7c2bbc1eaa142d1041a8">&#9670;&#160;</a></span>edns_client_subnet_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structedns__client__subnet__s.html">edns_client_subnet_s</a> <a class="el" href="group__query.html#ga3ca6aa22eb1e7c2bbc1eaa142d1041a8">edns_client_subnet_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Structure for EDNS client subnet option. </p>

</div>
</div>
<a id="gaeea966773633cbfc80d6a6c47e506d32" name="gaeea966773633cbfc80d6a6c47e506d32"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaeea966773633cbfc80d6a6c47e506d32">&#9670;&#160;</a></span>edns_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structedns__s.html">edns_s</a> <a class="el" href="group__query.html#gaeea966773633cbfc80d6a6c47e506d32">edns_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Structure for EDNS optional resource record. </p>

</div>
</div>
<a id="ga7e8eca656f657c57c3fb58c1d916fa18" name="ga7e8eca656f657c57c3fb58c1d916fa18"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga7e8eca656f657c57c3fb58c1d916fa18">&#9670;&#160;</a></span>query_log_loop_args_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structquery__log__loop__args__s.html">query_log_loop_args_s</a> <a class="el" href="group__query.html#ga7e8eca656f657c57c3fb58c1d916fa18">query_log_loop_args_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Structure holds arguments passed to <a class="el" href="group__query.html#gaaa3817325960b140b4ee9e6d2e1851c0">query_log_loop</a> function. </p>

</div>
</div>
<a id="gad71a97c752a76493cd34482f1a8cbd0c" name="gad71a97c752a76493cd34482f1a8cbd0c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gad71a97c752a76493cd34482f1a8cbd0c">&#9670;&#160;</a></span>query_log_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structquery__log__s.html">query_log_s</a> <a class="el" href="group__query.html#gad71a97c752a76493cd34482f1a8cbd0c">query_log_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Stucture describes a query log object.</p>
<p>Queries are logged into a buffer. There are two buffers, one is active, while the other one (inactive buffer) is having its data written to disk. This enables us to have no blocking operations (such as writing to disk) in the vectorloop.</p>
<p>Query logging thread uses channels to notify vectorloop thread when it should swap log buffers. Once VL thread swaps buffers, it sends a message back to query logging thread indicating so, which in turn signals the query logging thread that it should log data from VL inactive buffer to disk. Once data is written to disk the process repeats.</p>
<p>Each vectorloop thread has its own set of query log buffers.</p>
<p>Size of each buffer is set by configuration setting query_log_buffer_size. </p>

</div>
</div>
<a id="ga99fac2995915676a917f68a08bb7f007" name="ga99fac2995915676a917f68a08bb7f007"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga99fac2995915676a917f68a08bb7f007">&#9670;&#160;</a></span>query_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structquery__s.html">query_s</a> <a class="el" href="group__query.html#ga99fac2995915676a917f68a08bb7f007">query_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Structure describes a DNS query. <br  />
 </p>

</div>
</div>
<a id="gaa387be0f34555d2245e2bb0377efe9b0" name="gaa387be0f34555d2245e2bb0377efe9b0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaa387be0f34555d2245e2bb0377efe9b0">&#9670;&#160;</a></span>rr_record_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structrr__record__s.html">rr_record_s</a> <a class="el" href="group__query.html#gaa387be0f34555d2245e2bb0377efe9b0">rr_record_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Structure describes a DNS Resource Record. </p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="gaf93a1e779559c3be79eea93c16a04f7b" name="gaf93a1e779559c3be79eea93c16a04f7b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaf93a1e779559c3be79eea93c16a04f7b">&#9670;&#160;</a></span>query_clean()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void query_clean </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__query.html#ga99fac2995915676a917f68a08bb7f007">query_t</a> *&#160;</td>
          <td class="paramname"><em>q</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Clean a query object. This releases all memory owned by query object.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">q</td><td>Query to clean. </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__query_gaf93a1e779559c3be79eea93c16a04f7b_icgraph.png" border="0" usemap="#agroup__query_gaf93a1e779559c3be79eea93c16a04f7b_icgraph" alt=""/></div>
<map name="agroup__query_gaf93a1e779559c3be79eea93c16a04f7b_icgraph" id="agroup__query_gaf93a1e779559c3be79eea93c16a04f7b_icgraph">
<area shape="rect" title=" " alt="" coords="903,153,1004,179"/>
<area shape="rect" href="group__connection.html#gadac53f263515607663d4aa978de5db7f" title=" " alt="" coords="716,5,851,31"/>
<area shape="poly" title=" " alt="" coords="936,143,902,93,879,67,853,44,833,33,835,28,856,40,883,63,907,90,941,140"/>
<area shape="rect" href="group__connection.html#gabee18b63baa6df2f7f58929574fc53d2" title=" " alt="" coords="714,55,853,80"/>
<area shape="poly" title=" " alt="" coords="927,147,893,119,853,94,828,83,830,78,856,89,896,115,930,142"/>
<area shape="rect" href="group__query__object__ut.html#gadf13fe9eca3ea28fbbda3bcee4df08e5" title=" " alt="" coords="712,104,855,129"/>
<area shape="poly" title=" " alt="" coords="895,152,827,132,829,127,896,147"/>
<area shape="rect" href="group__query__object__ut.html#ga97930a0dcf7de86c0094d724275e8886" title=" " alt="" coords="759,153,807,179"/>
<area shape="poly" title=" " alt="" coords="889,169,808,169,808,163,889,163"/>
<area shape="rect" href="group__query__object__ut.html#ga572ffe042aa5a0c95b3d17b9c4d45caa" title=" " alt="" coords="759,203,807,228"/>
<area shape="poly" title=" " alt="" coords="897,185,808,211,807,206,895,180"/>
<area shape="rect" href="group__query__object__ut.html#ga9dc1fe1c51e55576bd311c6f04705156" title=" " alt="" coords="759,252,807,277"/>
<area shape="poly" title=" " alt="" coords="929,190,895,216,856,242,808,261,806,256,853,237,892,212,926,186"/>
<area shape="rect" href="group__query__object__ut.html#gaf40dc6e78b74bed89ed77bd6a82758c3" title=" " alt="" coords="759,301,807,327"/>
<area shape="poly" title=" " alt="" coords="941,192,906,241,883,268,856,291,832,304,808,312,807,307,830,299,853,286,879,264,902,238,936,189"/>
<area shape="rect" href="group__connection.html#gaa471b14985d2c49e36bad11ef55aa5d5" title=" " alt="" coords="556,31,664,56"/>
<area shape="poly" title=" " alt="" coords="703,32,665,38,664,33,702,27"/>
<area shape="rect" href="vectorloop_8c.html#af1c0a2ea663ab908b04574a0e3fca5d0" title=" " alt="" coords="333,31,508,56"/>
<area shape="poly" title=" " alt="" coords="542,46,508,46,508,41,542,41"/>
<area shape="rect" href="group__vectorloop.html#ga8085b92988a2a04a741421ec75c785cd" title=" " alt="" coords="223,31,285,56"/>
<area shape="poly" title=" " alt="" coords="319,46,285,46,285,41,319,41"/>
<area shape="rect" href="group__ripples.html#ga3448cc4395fbd9b27bb229a87337067d" title=" " alt="" coords="108,31,175,56"/>
<area shape="poly" title=" " alt="" coords="209,46,175,46,175,41,209,41"/>
<area shape="rect" href="main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,31,60,56"/>
<area shape="poly" title=" " alt="" coords="94,46,60,46,60,41,94,41"/>
<area shape="poly" title=" " alt="" coords="700,58,664,53,664,48,701,53"/>
</map>
</div>

</div>
</div>
<a id="gaf02c91b2cf24240c2a4e9e6c82fd1ee8" name="gaf02c91b2cf24240c2a4e9e6c82fd1ee8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaf02c91b2cf24240c2a4e9e6c82fd1ee8">&#9670;&#160;</a></span>query_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void query_init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__query.html#ga99fac2995915676a917f68a08bb7f007">query_t</a> *&#160;</td>
          <td class="paramname"><em>q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__config.html#ga774ff96b58a051085872c40050a75a73">config_t</a> *&#160;</td>
          <td class="paramname"><em>cfg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>protocol</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Initialize a query object.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">q</td><td>Query object to initialize. </td></tr>
    <tr><td class="paramname">cfg</td><td>Configuration with settings to use. </td></tr>
    <tr><td class="paramname">protocol</td><td>Transport protocol used for query. Valid options are 0 = UDP, 1 = TCP. </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__query_gaf02c91b2cf24240c2a4e9e6c82fd1ee8_icgraph.png" border="0" usemap="#agroup__query_gaf02c91b2cf24240c2a4e9e6c82fd1ee8_icgraph" alt=""/></div>
<map name="agroup__query_gaf02c91b2cf24240c2a4e9e6c82fd1ee8_icgraph" id="agroup__query_gaf02c91b2cf24240c2a4e9e6c82fd1ee8_icgraph">
<area shape="rect" title=" " alt="" coords="972,179,1059,204"/>
<area shape="rect" href="group__connection.html#ga23dbbd3e61761b5d606aea5e152d82a4" title=" " alt="" coords="795,5,910,31"/>
<area shape="poly" title=" " alt="" coords="1002,167,972,106,950,74,922,45,901,33,904,28,926,41,954,70,977,103,1007,165"/>
<area shape="rect" href="group__connection.html#ga9ba61b0037b29fd772fd609fc7298f32" title=" " alt="" coords="793,55,912,80"/>
<area shape="poly" title=" " alt="" coords="996,169,964,131,923,95,898,82,900,78,925,90,968,128,1000,166"/>
<area shape="rect" href="group__query__parse__ut.html#gaf477f506b934260a80c91285037b579b" title=" " alt="" coords="781,104,924,129"/>
<area shape="poly" title=" " alt="" coords="980,174,923,144,892,132,894,127,925,140,982,169"/>
<area shape="rect" href="group__query__object__ut.html#gadf13fe9eca3ea28fbbda3bcee4df08e5" title=" " alt="" coords="781,153,924,179"/>
<area shape="poly" title=" " alt="" coords="958,185,924,180,925,174,959,180"/>
<area shape="rect" href="group__query__object__ut.html#ga97930a0dcf7de86c0094d724275e8886" title=" " alt="" coords="829,203,877,228"/>
<area shape="poly" title=" " alt="" coords="959,202,877,215,877,209,958,197"/>
<area shape="rect" href="group__query__object__ut.html#ga572ffe042aa5a0c95b3d17b9c4d45caa" title=" " alt="" coords="829,252,877,277"/>
<area shape="poly" title=" " alt="" coords="982,213,925,243,878,260,876,255,923,238,980,209"/>
<area shape="rect" href="group__query__object__ut.html#ga9dc1fe1c51e55576bd311c6f04705156" title=" " alt="" coords="829,301,877,327"/>
<area shape="poly" title=" " alt="" coords="1000,217,968,255,925,292,901,304,878,312,876,307,899,299,923,288,964,252,996,214"/>
<area shape="rect" href="group__query__object__ut.html#gaf40dc6e78b74bed89ed77bd6a82758c3" title=" " alt="" coords="829,351,877,376"/>
<area shape="poly" title=" " alt="" coords="1007,218,977,280,954,313,926,341,902,355,878,362,876,357,900,350,922,337,950,309,973,277,1002,216"/>
<area shape="rect" href="vectorloop_8c.html#a371732e8f9099d28d19764a3ff11361a" title=" " alt="" coords="333,5,509,31"/>
<area shape="poly" title=" " alt="" coords="781,21,510,21,510,15,781,15"/>
<area shape="rect" href="group__vectorloop.html#ga8085b92988a2a04a741421ec75c785cd" title=" " alt="" coords="223,31,285,56"/>
<area shape="poly" title=" " alt="" coords="324,35,286,41,285,36,323,30"/>
<area shape="rect" href="group__ripples.html#ga3448cc4395fbd9b27bb229a87337067d" title=" " alt="" coords="108,31,175,56"/>
<area shape="poly" title=" " alt="" coords="209,46,175,46,175,41,209,41"/>
<area shape="rect" href="main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,31,60,56"/>
<area shape="poly" title=" " alt="" coords="94,46,60,46,60,41,94,41"/>
<area shape="rect" href="group__connection.html#ga2650666a5c634ee8a0359b770c0e63a0" title=" " alt="" coords="557,55,733,80"/>
<area shape="poly" title=" " alt="" coords="780,70,734,70,734,65,780,65"/>
<area shape="rect" href="vectorloop_8c.html#aa1774e5d77c9901f6b55b6efd15a181e" title=" " alt="" coords="344,55,499,80"/>
<area shape="poly" title=" " alt="" coords="543,70,499,70,499,65,543,65"/>
<area shape="poly" title=" " alt="" coords="330,57,285,50,286,45,331,52"/>
</map>
</div>

</div>
</div>
<a id="gadc83ee2842f0e028220d0bfc21fe2a29" name="gadc83ee2842f0e028220d0bfc21fe2a29"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gadc83ee2842f0e028220d0bfc21fe2a29">&#9670;&#160;</a></span>query_log()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int query_log </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>buf_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__query.html#ga99fac2995915676a917f68a08bb7f007">query_t</a> *&#160;</td>
          <td class="paramname"><em>q</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Log query to buffer.</p>
<p>Query log entry ends with new line "\n" (one query per line).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">buf</td><td>Buffer to log query to. </td></tr>
    <tr><td class="paramname">buf_len</td><td>Length of buffer (available space). </td></tr>
    <tr><td class="paramname">q</td><td>Query to log.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns number of bytes added to buf on success, otherwise returns 0 and error occurred (ie not enough room in buffer, or not a logable query end code) and nothing was added to buf. </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__query_gadc83ee2842f0e028220d0bfc21fe2a29_cgraph.png" border="0" usemap="#agroup__query_gadc83ee2842f0e028220d0bfc21fe2a29_cgraph" alt=""/></div>
<map name="agroup__query_gadc83ee2842f0e028220d0bfc21fe2a29_cgraph" id="agroup__query_gadc83ee2842f0e028220d0bfc21fe2a29_cgraph">
<area shape="rect" title=" " alt="" coords="5,55,92,80"/>
<area shape="rect" href="group__nsutils.html#gacd268aeb60c39b8047ed3141ed123cc4" title=" " alt="" coords="175,5,320,31"/>
<area shape="poly" title=" " alt="" coords="91,52,139,39,173,31,174,36,141,45,93,58"/>
<area shape="rect" href="group__nsutils.html#ga832e4d16ea8aabc1e4b9a57ed4dca504" title=" " alt="" coords="168,55,327,80"/>
<area shape="poly" title=" " alt="" coords="92,65,154,65,154,70,92,70"/>
<area shape="rect" href="group__utils.html#ga87e48cf8f0473484e26ccc18213286da" title=" " alt="" coords="140,104,355,129"/>
<area shape="poly" title=" " alt="" coords="93,76,141,89,179,98,178,103,139,94,91,81"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__query_gadc83ee2842f0e028220d0bfc21fe2a29_icgraph.png" border="0" usemap="#agroup__query_gadc83ee2842f0e028220d0bfc21fe2a29_icgraph" alt=""/></div>
<map name="agroup__query_gadc83ee2842f0e028220d0bfc21fe2a29_icgraph" id="agroup__query_gadc83ee2842f0e028220d0bfc21fe2a29_icgraph">
<area shape="rect" title=" " alt="" coords="747,31,833,56"/>
<area shape="rect" href="group__query.html#ga7dc1c1717d6768694ec783ef8d796c8e" title=" " alt="" coords="567,5,699,31"/>
<area shape="poly" title=" " alt="" coords="733,37,698,31,699,26,734,32"/>
<area shape="rect" href="vectorloop_8c.html#abfedd1f470befe2c8a6d5c8d029488d2" title=" " alt="" coords="363,56,489,81"/>
<area shape="poly" title=" " alt="" coords="733,50,489,67,489,62,733,45"/>
<area shape="rect" href="vectorloop_8c.html#a2fb9c21ccae4e0e247977e2b77a82d7d" title=" " alt="" coords="333,7,519,32"/>
<area shape="poly" title=" " alt="" coords="553,21,519,21,519,16,553,16"/>
<area shape="rect" href="group__vectorloop.html#ga8085b92988a2a04a741421ec75c785cd" title=" " alt="" coords="223,32,285,57"/>
<area shape="poly" title=" " alt="" coords="326,37,286,43,285,38,326,31"/>
<area shape="rect" href="group__ripples.html#ga3448cc4395fbd9b27bb229a87337067d" title=" " alt="" coords="108,32,175,57"/>
<area shape="poly" title=" " alt="" coords="209,47,175,47,175,42,209,42"/>
<area shape="rect" href="main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,32,60,57"/>
<area shape="poly" title=" " alt="" coords="94,47,60,47,60,42,94,42"/>
<area shape="poly" title=" " alt="" coords="349,61,285,52,286,46,350,55"/>
</map>
</div>

</div>
</div>
<a id="gaaa3817325960b140b4ee9e6d2e1851c0" name="gaaa3817325960b140b4ee9e6d2e1851c0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaaa3817325960b140b4ee9e6d2e1851c0">&#9670;&#160;</a></span>query_log_loop()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void * query_log_loop </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>args</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Function polls vectorloop threads for query log data and writes it to file. This function is meant to run in its own dedicated thread.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">args</td><td>Structure with settings to use.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns nULL just to abide by the pthread API. </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__query_gaaa3817325960b140b4ee9e6d2e1851c0_cgraph.png" border="0" usemap="#agroup__query_gaaa3817325960b140b4ee9e6d2e1851c0_cgraph" alt=""/></div>
<map name="agroup__query_gaaa3817325960b140b4ee9e6d2e1851c0_cgraph" id="agroup__query_gaaa3817325960b140b4ee9e6d2e1851c0_cgraph">
<area shape="rect" title=" " alt="" coords="5,218,127,243"/>
<area shape="rect" href="group__channels.html#ga3f043e35fd50c949b43b1e11e4e558c0" title=" " alt="" coords="195,5,346,45"/>
<area shape="poly" title=" " alt="" coords="69,217,82,184,104,141,134,95,173,55,182,49,185,54,176,59,138,98,109,144,87,187,74,219"/>
<area shape="rect" href="group__channels.html#ga7429c17b25e3fb4daadc0d7982b58a2c" title=" " alt="" coords="178,70,363,95"/>
<area shape="poly" title=" " alt="" coords="72,216,111,162,139,131,173,104,185,98,188,103,176,109,143,135,115,165,77,219"/>
<area shape="rect" href="group__channels.html#ga126a303de9831687e035fec4f44f3e77" title=" " alt="" coords="175,119,367,145"/>
<area shape="poly" title=" " alt="" coords="80,216,121,185,173,154,192,146,194,151,176,158,124,189,84,220"/>
<area shape="rect" href="group__channels.html#ga6f4f7d1af62d1f629e89130feda7496a" title=" " alt="" coords="201,169,341,194"/>
<area shape="poly" title=" " alt="" coords="119,215,203,195,205,200,120,221"/>
<area shape="rect" href="group__channels.html#gad13f097d851bab9792cd0b397eef59c3" title=" " alt="" coords="196,218,345,243"/>
<area shape="poly" title=" " alt="" coords="127,228,182,228,182,233,127,233"/>
<area shape="rect" href="group__channels.html#ga180670c9b496fee9bd62be81ce23c000" title=" " alt="" coords="179,267,362,293"/>
<area shape="poly" title=" " alt="" coords="120,241,205,261,203,267,119,246"/>
<area shape="rect" href="group__channels.html#ga19fdf087fec4b517a0c5de35a8e426bc" title=" " alt="" coords="201,317,340,342"/>
<area shape="poly" title=" " alt="" coords="84,241,124,271,176,302,198,310,196,315,174,306,121,276,81,246"/>
<area shape="rect" href="query__log__loop_8c.html#affd67c91830684b78238e2a2866201f7" title=" " alt="" coords="181,366,361,391"/>
<area shape="poly" title=" " alt="" coords="77,242,115,295,143,326,176,351,190,358,188,363,173,356,140,329,111,299,73,245"/>
<area shape="rect" href="group__utils.html#ga56253d3610caabc8e9e76170f5a4e15d" title=" " alt="" coords="223,415,318,441"/>
<area shape="poly" title=" " alt="" coords="74,243,87,275,108,318,138,363,176,400,211,417,208,422,173,405,134,366,103,321,82,277,69,245"/>
<area shape="rect" href="group__utils.html#ga49835fc63273ccae7b18241d346e14b1" title=" " alt="" coords="445,329,599,369"/>
<area shape="poly" title=" " alt="" coords="360,366,431,357,431,363,361,371"/>
<area shape="rect" href="group__utils.html#ga87e48cf8f0473484e26ccc18213286da" title=" " alt="" coords="415,394,629,419"/>
<area shape="poly" title=" " alt="" coords="361,386,401,391,401,396,360,391"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__query_gaaa3817325960b140b4ee9e6d2e1851c0_icgraph.png" border="0" usemap="#agroup__query_gaaa3817325960b140b4ee9e6d2e1851c0_icgraph" alt=""/></div>
<map name="agroup__query_gaaa3817325960b140b4ee9e6d2e1851c0_icgraph" id="agroup__query_gaaa3817325960b140b4ee9e6d2e1851c0_icgraph">
<area shape="rect" title=" " alt="" coords="223,5,344,31"/>
<area shape="rect" href="group__ripples.html#ga3448cc4395fbd9b27bb229a87337067d" title=" " alt="" coords="108,5,175,31"/>
<area shape="poly" title=" " alt="" coords="209,21,175,21,175,15,209,15"/>
<area shape="rect" href="main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,5,60,31"/>
<area shape="poly" title=" " alt="" coords="94,21,60,21,60,15,94,15"/>
</map>
</div>

</div>
</div>
<a id="ga7dc1c1717d6768694ec783ef8d796c8e" name="ga7dc1c1717d6768694ec783ef8d796c8e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga7dc1c1717d6768694ec783ef8d796c8e">&#9670;&#160;</a></span>query_log_rotate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void query_log_rotate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__query.html#gad71a97c752a76493cd34482f1a8cbd0c">query_log_t</a> *&#160;</td>
          <td class="paramname"><em>query_log</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Rotate query log.</p>
<p>Active log to write queries is switched to the other side.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">query_log</td><td>Query log to rotate. </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__query_ga7dc1c1717d6768694ec783ef8d796c8e_cgraph.png" border="0" usemap="#agroup__query_ga7dc1c1717d6768694ec783ef8d796c8e_cgraph" alt=""/></div>
<map name="agroup__query_ga7dc1c1717d6768694ec783ef8d796c8e_cgraph" id="agroup__query_ga7dc1c1717d6768694ec783ef8d796c8e_cgraph">
<area shape="rect" title=" " alt="" coords="5,55,137,80"/>
<area shape="rect" href="group__query.html#gadc83ee2842f0e028220d0bfc21fe2a29" title=" " alt="" coords="185,55,272,80"/>
<area shape="poly" title=" " alt="" coords="137,65,171,65,171,70,137,70"/>
<area shape="rect" href="group__nsutils.html#gacd268aeb60c39b8047ed3141ed123cc4" title=" " alt="" coords="355,5,500,31"/>
<area shape="poly" title=" " alt="" coords="271,52,319,39,353,31,354,36,321,45,273,58"/>
<area shape="rect" href="group__nsutils.html#ga832e4d16ea8aabc1e4b9a57ed4dca504" title=" " alt="" coords="348,55,507,80"/>
<area shape="poly" title=" " alt="" coords="272,65,334,65,334,70,272,70"/>
<area shape="rect" href="group__utils.html#ga87e48cf8f0473484e26ccc18213286da" title=" " alt="" coords="320,104,535,129"/>
<area shape="poly" title=" " alt="" coords="273,76,321,89,359,98,358,103,319,94,271,81"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__query_ga7dc1c1717d6768694ec783ef8d796c8e_icgraph.png" border="0" usemap="#agroup__query_ga7dc1c1717d6768694ec783ef8d796c8e_icgraph" alt=""/></div>
<map name="agroup__query_ga7dc1c1717d6768694ec783ef8d796c8e_icgraph" id="agroup__query_ga7dc1c1717d6768694ec783ef8d796c8e_icgraph">
<area shape="rect" title=" " alt="" coords="567,5,699,31"/>
<area shape="rect" href="vectorloop_8c.html#a2fb9c21ccae4e0e247977e2b77a82d7d" title=" " alt="" coords="333,5,519,31"/>
<area shape="poly" title=" " alt="" coords="553,21,519,21,519,15,553,15"/>
<area shape="rect" href="group__vectorloop.html#ga8085b92988a2a04a741421ec75c785cd" title=" " alt="" coords="223,5,285,31"/>
<area shape="poly" title=" " alt="" coords="320,21,286,21,286,15,320,15"/>
<area shape="rect" href="group__ripples.html#ga3448cc4395fbd9b27bb229a87337067d" title=" " alt="" coords="108,5,175,31"/>
<area shape="poly" title=" " alt="" coords="209,21,175,21,175,15,209,15"/>
<area shape="rect" href="main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,5,60,31"/>
<area shape="poly" title=" " alt="" coords="94,21,60,21,60,15,94,15"/>
</map>
</div>

</div>
</div>
<a id="gadebe69962416277a46fe9908ceb29269" name="gadebe69962416277a46fe9908ceb29269"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gadebe69962416277a46fe9908ceb29269">&#9670;&#160;</a></span>query_pack_edns()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int query_pack_edns </td>
          <td>(</td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>buf_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__query.html#gaeea966773633cbfc80d6a6c47e506d32">edns_t</a> *&#160;</td>
          <td class="paramname"><em>edns</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Pack EDNS and it extensions into buffer.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">buf</td><td>Buffer to pack EDNS and extensions into. </td></tr>
    <tr><td class="paramname">buf_len</td><td>Length in bytes of available space in buffer. </td></tr>
    <tr><td class="paramname">edns</td><td>EDNS object to pack.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>On success returns number of bytes packed into buffer. 0 is returned if edns object does not contain valid data. -1 is returned if there is not enough room in buffer to pack EDNS and all its extensions in which case buf is left untouched. </dd></dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__query_gadebe69962416277a46fe9908ceb29269_icgraph.png" border="0" usemap="#agroup__query_gadebe69962416277a46fe9908ceb29269_icgraph" alt=""/></div>
<map name="agroup__query_gadebe69962416277a46fe9908ceb29269_icgraph" id="agroup__query_gadebe69962416277a46fe9908ceb29269_icgraph">
<area shape="rect" title=" " alt="" coords="795,5,929,31"/>
<area shape="rect" href="group__query.html#gac374ae1c30bca42b0cbd283a584c97eb" title=" " alt="" coords="584,5,747,31"/>
<area shape="poly" title=" " alt="" coords="781,21,747,21,747,15,781,15"/>
<area shape="rect" href="vectorloop_8c.html#a992bdcae5a48e85fd09be95753553ab7" title=" " alt="" coords="333,5,536,31"/>
<area shape="poly" title=" " alt="" coords="570,21,536,21,536,15,570,15"/>
<area shape="rect" href="group__vectorloop.html#ga8085b92988a2a04a741421ec75c785cd" title=" " alt="" coords="223,5,285,31"/>
<area shape="poly" title=" " alt="" coords="319,21,286,21,286,15,319,15"/>
<area shape="rect" href="group__ripples.html#ga3448cc4395fbd9b27bb229a87337067d" title=" " alt="" coords="108,5,175,31"/>
<area shape="poly" title=" " alt="" coords="209,21,175,21,175,15,209,15"/>
<area shape="rect" href="main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,5,60,31"/>
<area shape="poly" title=" " alt="" coords="94,21,60,21,60,15,94,15"/>
</map>
</div>

</div>
</div>
<a id="ga3e057ac872e708a9a49729628ca09051" name="ga3e057ac872e708a9a49729628ca09051"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga3e057ac872e708a9a49729628ca09051">&#9670;&#160;</a></span>query_pack_rr()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int query_pack_rr </td>
          <td>(</td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__query.html#gaa387be0f34555d2245e2bb0377efe9b0">rr_record_t</a> *&#160;</td>
          <td class="paramname"><em>rr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>buf_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char **&#160;</td>
          <td class="paramname"><em>dnptrs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char **&#160;</td>
          <td class="paramname"><em>lastdnptr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Pack resource record into buffer, non-EDNS. TO pack EDNS use <a class="el" href="group__query.html#gadebe69962416277a46fe9908ceb29269">query_pack_edns</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">name</td><td>Name to use to when packing RR. If NULL name in rr is used. </td></tr>
    <tr><td class="paramname">rr</td><td>Resource record to pack. </td></tr>
    <tr><td class="paramname">buf</td><td>Buffer into which to pack the record. </td></tr>
    <tr><td class="paramname">buf_len</td><td>Length (in bytes) of available space in buffer. </td></tr>
    <tr><td class="paramname">dnptrs</td><td>Pointer to first entry in domain name array used to track names already packed. </td></tr>
    <tr><td class="paramname">lastdnptr</td><td>Last entry in domain name array.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>On success returns number of bytes packed into buffer, Otherwise error occurred. Currently error can occur if there if not enough room in buffer to pack the record. </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__query_ga3e057ac872e708a9a49729628ca09051_cgraph.png" border="0" usemap="#agroup__query_ga3e057ac872e708a9a49729628ca09051_cgraph" alt=""/></div>
<map name="agroup__query_ga3e057ac872e708a9a49729628ca09051_cgraph" id="agroup__query_ga3e057ac872e708a9a49729628ca09051_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,120,56"/>
<area shape="rect" href="group__nsutils.html#ga28b1360ba956ef26eabf03fcda097032" title=" " alt="" coords="168,31,301,56"/>
<area shape="poly" title=" " alt="" coords="120,41,154,41,154,46,120,46"/>
<area shape="rect" href="group__nsutils.html#ga3ac967006e91ec4daf82046bbcd00edd" title=" " alt="" coords="349,5,492,31"/>
<area shape="poly" title=" " alt="" coords="301,32,335,27,336,32,302,37"/>
<area shape="rect" href="group__nsutils.html#gae88775d52f18a015532678abda660b0f" title=" " alt="" coords="350,55,491,80"/>
<area shape="poly" title=" " alt="" coords="302,49,337,54,336,59,301,55"/>
<area shape="rect" href="rip__ns__utils_8c.html#adf2f188c0488073e3df5497fcc6e4b35" title=" " alt="" coords="540,5,633,31"/>
<area shape="poly" title=" " alt="" coords="492,15,526,15,526,21,492,21"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__query_ga3e057ac872e708a9a49729628ca09051_icgraph.png" border="0" usemap="#agroup__query_ga3e057ac872e708a9a49729628ca09051_icgraph" alt=""/></div>
<map name="agroup__query_ga3e057ac872e708a9a49729628ca09051_icgraph" id="agroup__query_ga3e057ac872e708a9a49729628ca09051_icgraph">
<area shape="rect" title=" " alt="" coords="795,5,909,31"/>
<area shape="rect" href="group__query.html#gac374ae1c30bca42b0cbd283a584c97eb" title=" " alt="" coords="584,5,747,31"/>
<area shape="poly" title=" " alt="" coords="781,21,747,21,747,15,781,15"/>
<area shape="rect" href="vectorloop_8c.html#a992bdcae5a48e85fd09be95753553ab7" title=" " alt="" coords="333,5,536,31"/>
<area shape="poly" title=" " alt="" coords="570,21,536,21,536,15,570,15"/>
<area shape="rect" href="group__vectorloop.html#ga8085b92988a2a04a741421ec75c785cd" title=" " alt="" coords="223,5,285,31"/>
<area shape="poly" title=" " alt="" coords="319,21,286,21,286,15,319,15"/>
<area shape="rect" href="group__ripples.html#ga3448cc4395fbd9b27bb229a87337067d" title=" " alt="" coords="108,5,175,31"/>
<area shape="poly" title=" " alt="" coords="209,21,175,21,175,15,209,15"/>
<area shape="rect" href="main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,5,60,31"/>
<area shape="poly" title=" " alt="" coords="94,21,60,21,60,15,94,15"/>
</map>
</div>

</div>
</div>
<a id="gaa6dc55685778db382330d1e4ef70d3df" name="gaa6dc55685778db382330d1e4ef70d3df"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaa6dc55685778db382330d1e4ef70d3df">&#9670;&#160;</a></span>query_parse()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void query_parse </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__query.html#ga99fac2995915676a917f68a08bb7f007">query_t</a> *&#160;</td>
          <td class="paramname"><em>q</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Parse query request from request buffer into query_t structure fields.</p>
<p>DNS request &amp; response format is as per RFC 1035 <a href="https://datatracker.ietf.org/doc/html/rfc1035">https://datatracker.ietf.org/doc/html/rfc1035</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">q</td><td>Query to parse DNS request for. </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__query_gaa6dc55685778db382330d1e4ef70d3df_cgraph.png" border="0" usemap="#agroup__query_gaa6dc55685778db382330d1e4ef70d3df_cgraph" alt=""/></div>
<map name="agroup__query_gaa6dc55685778db382330d1e4ef70d3df_cgraph" id="agroup__query_gaa6dc55685778db382330d1e4ef70d3df_cgraph">
<area shape="rect" title=" " alt="" coords="5,105,108,131"/>
<area shape="rect" href="group__query.html#ga4387ff7b5e07e5b8249928c0bb1ac35b" title=" " alt="" coords="156,49,315,89"/>
<area shape="poly" title=" " alt="" coords="103,103,149,90,150,95,104,108"/>
<area shape="rect" href="group__query.html#ga0df26d3c47404b5de3f17d9b3d2a8468" title=" " alt="" coords="156,130,315,170"/>
<area shape="poly" title=" " alt="" coords="109,125,143,131,142,136,108,130"/>
<area shape="rect" href="group__query.html#gaecf6360b330f2f7a882b4d0eca5d6da3" title=" " alt="" coords="374,5,542,31"/>
<area shape="poly" title=" " alt="" coords="314,48,388,31,389,36,315,53"/>
<area shape="rect" href="group__nsutils.html#ga9c3693281a90d416c4574dc690649be9" title=" " alt="" coords="617,105,775,131"/>
<area shape="poly" title=" " alt="" coords="315,70,428,79,554,91,614,100,613,106,553,97,428,84,315,76"/>
<area shape="rect" href="group__query.html#ga49ccb0e164ee4f981443c01bda0b7224" title=" " alt="" coords="601,5,791,31"/>
<area shape="poly" title=" " alt="" coords="542,15,588,15,588,21,542,21"/>
<area shape="rect" href="group__nsutils.html#ga3fbc63b1755777c7c8e4dfbc34c038e6" title=" " alt="" coords="363,107,553,132"/>
<area shape="poly" title=" " alt="" coords="314,136,352,131,352,137,315,142"/>
<area shape="rect" href="group__nsutils.html#ga353a9e812c934fe3559c11340c0913ad" title=" " alt="" coords="365,156,551,181"/>
<area shape="poly" title=" " alt="" coords="315,154,351,157,351,162,315,159"/>
<area shape="rect" href="group__nsutils.html#gaa3975da9d09ac3fed8f402eb992927e2" title=" " alt="" coords="394,205,522,231"/>
<area shape="poly" title=" " alt="" coords="292,168,363,191,391,199,389,204,362,197,290,173"/>
<area shape="poly" title=" " alt="" coords="517,203,552,192,612,164,662,135,665,140,614,169,554,196,519,208"/>
<area shape="rect" href="group__nsutils.html#ga7af536be87c215ae9fef0a19d5e39fa4" title=" " alt="" coords="625,205,767,231"/>
<area shape="poly" title=" " alt="" coords="522,215,612,215,612,221,522,221"/>
<area shape="rect" href="rip__ns__utils_8c.html#af80ef420be17f5df8caa419b9182026e" title=" " alt="" coords="839,180,919,205"/>
<area shape="poly" title=" " alt="" coords="767,206,825,197,826,203,767,211"/>
<area shape="rect" href="rip__ns__utils_8c.html#aab66a853b32f5d595cf0121a3b9b87a3" title=" " alt="" coords="845,229,913,255"/>
<area shape="poly" title=" " alt="" coords="767,225,831,233,831,238,767,230"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__query_gaa6dc55685778db382330d1e4ef70d3df_icgraph.png" border="0" usemap="#agroup__query_gaa6dc55685778db382330d1e4ef70d3df_icgraph" alt=""/></div>
<map name="agroup__query_gaa6dc55685778db382330d1e4ef70d3df_icgraph" id="agroup__query_gaa6dc55685778db382330d1e4ef70d3df_icgraph">
<area shape="rect" title=" " alt="" coords="524,31,627,56"/>
<area shape="rect" href="group__query__parse__ut.html#gaf477f506b934260a80c91285037b579b" title=" " alt="" coords="333,5,476,31"/>
<area shape="poly" title=" " alt="" coords="510,36,476,31,477,26,511,31"/>
<area shape="rect" href="vectorloop_8c.html#a2bb1129e00edf873d9eba6cb9b4517bf" title=" " alt="" coords="334,55,475,80"/>
<area shape="poly" title=" " alt="" coords="511,55,476,60,475,55,510,50"/>
<area shape="rect" href="group__vectorloop.html#ga8085b92988a2a04a741421ec75c785cd" title=" " alt="" coords="223,55,285,80"/>
<area shape="poly" title=" " alt="" coords="320,70,285,70,285,65,320,65"/>
<area shape="rect" href="group__ripples.html#ga3448cc4395fbd9b27bb229a87337067d" title=" " alt="" coords="108,55,175,80"/>
<area shape="poly" title=" " alt="" coords="209,70,175,70,175,65,209,65"/>
<area shape="rect" href="main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,55,60,80"/>
<area shape="poly" title=" " alt="" coords="94,70,60,70,60,65,94,65"/>
</map>
</div>

</div>
</div>
<a id="gaecf6360b330f2f7a882b4d0eca5d6da3" name="gaecf6360b330f2f7a882b4d0eca5d6da3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaecf6360b330f2f7a882b4d0eca5d6da3">&#9670;&#160;</a></span>query_parse_edns_ext()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int query_parse_edns_ext </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__query.html#ga99fac2995915676a917f68a08bb7f007">query_t</a> *&#160;</td>
          <td class="paramname"><em>q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>eobuf</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Parse EDNS extensions.</p>
<p>Format of EDNS option is: 2 bytes = Option code, 2 bytes = Option length (length that follows), Option length bytes = option specific</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">q</td><td>Query to parse extensions into. </td></tr>
    <tr><td class="paramname">buf</td><td>Buffer to parse extensions from. </td></tr>
    <tr><td class="paramname">eobuf</td><td>End of buffer.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns 0 on success, otherwise an error occurred i.e. format error. </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__query_gaecf6360b330f2f7a882b4d0eca5d6da3_cgraph.png" border="0" usemap="#agroup__query_gaecf6360b330f2f7a882b4d0eca5d6da3_cgraph" alt=""/></div>
<map name="agroup__query_gaecf6360b330f2f7a882b4d0eca5d6da3_cgraph" id="agroup__query_gaecf6360b330f2f7a882b4d0eca5d6da3_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,173,31"/>
<area shape="rect" href="group__query.html#ga49ccb0e164ee4f981443c01bda0b7224" title=" " alt="" coords="221,5,411,31"/>
<area shape="poly" title=" " alt="" coords="173,15,208,15,208,21,173,21"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__query_gaecf6360b330f2f7a882b4d0eca5d6da3_icgraph.png" border="0" usemap="#agroup__query_gaecf6360b330f2f7a882b4d0eca5d6da3_icgraph" alt=""/></div>
<map name="agroup__query_gaecf6360b330f2f7a882b4d0eca5d6da3_icgraph" id="agroup__query_gaecf6360b330f2f7a882b4d0eca5d6da3_icgraph">
<area shape="rect" title=" " alt="" coords="881,35,1049,60"/>
<area shape="rect" href="group__query__parse__edns__ext__ut.html#ga21eaeabf660d4d9f29291671a1cbd465" title=" " alt="" coords="683,5,825,31"/>
<area shape="poly" title=" " alt="" coords="867,36,825,30,826,25,868,31"/>
<area shape="rect" href="group__query.html#ga4387ff7b5e07e5b8249928c0bb1ac35b" title=" " alt="" coords="675,55,833,95"/>
<area shape="poly" title=" " alt="" coords="868,63,834,68,833,62,867,58"/>
<area shape="rect" href="group__query.html#gaa6dc55685778db382330d1e4ef70d3df" title=" " alt="" coords="524,63,627,88"/>
<area shape="poly" title=" " alt="" coords="661,78,627,78,627,73,661,73"/>
<area shape="rect" href="group__query__parse__ut.html#gaf477f506b934260a80c91285037b579b" title=" " alt="" coords="333,37,476,63"/>
<area shape="poly" title=" " alt="" coords="510,68,476,63,477,58,511,63"/>
<area shape="rect" href="vectorloop_8c.html#a2bb1129e00edf873d9eba6cb9b4517bf" title=" " alt="" coords="334,87,475,112"/>
<area shape="poly" title=" " alt="" coords="511,87,476,92,475,87,510,82"/>
<area shape="rect" href="group__vectorloop.html#ga8085b92988a2a04a741421ec75c785cd" title=" " alt="" coords="223,87,285,112"/>
<area shape="poly" title=" " alt="" coords="320,102,285,102,285,97,320,97"/>
<area shape="rect" href="group__ripples.html#ga3448cc4395fbd9b27bb229a87337067d" title=" " alt="" coords="108,87,175,112"/>
<area shape="poly" title=" " alt="" coords="209,102,175,102,175,97,209,97"/>
<area shape="rect" href="main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,87,60,112"/>
<area shape="poly" title=" " alt="" coords="94,102,60,102,60,97,94,97"/>
</map>
</div>

</div>
</div>
<a id="ga49ccb0e164ee4f981443c01bda0b7224" name="ga49ccb0e164ee4f981443c01bda0b7224"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga49ccb0e164ee4f981443c01bda0b7224">&#9670;&#160;</a></span>query_parse_edns_ext_cs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int query_parse_edns_ext_cs </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__query.html#ga3ca6aa22eb1e7c2bbc1eaa142d1041a8">edns_client_subnet_t</a> *&#160;</td>
          <td class="paramname"><em>cs</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Parse EDNS extension client subnet.</p>
<p>Format is:<br  />
 2 bytes = family<br  />
 1 byte = source netmask<br  />
 1 byte = scope netmask<br  />
 remaining bytes = client subnet<br  />
</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cs</td><td>EDNS client subnet object to parse data into.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns 0 on success, otherwise error occurred i.e. format error or unsupported address family. </dd></dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__query_ga49ccb0e164ee4f981443c01bda0b7224_icgraph.png" border="0" usemap="#agroup__query_ga49ccb0e164ee4f981443c01bda0b7224_icgraph" alt=""/></div>
<map name="agroup__query_ga49ccb0e164ee4f981443c01bda0b7224_icgraph" id="agroup__query_ga49ccb0e164ee4f981443c01bda0b7224_icgraph">
<area shape="rect" title=" " alt="" coords="1097,31,1287,56"/>
<area shape="rect" href="group__query__parse__edns__ext__cs__ut.html#ga2dac7344fa7a8215dd6677cd39d560d8" title=" " alt="" coords="894,5,1037,31"/>
<area shape="poly" title=" " alt="" coords="1083,34,1037,29,1037,23,1084,29"/>
<area shape="rect" href="group__query.html#gaecf6360b330f2f7a882b4d0eca5d6da3" title=" " alt="" coords="881,55,1049,80"/>
<area shape="poly" title=" " alt="" coords="1084,57,1050,61,1049,56,1083,52"/>
<area shape="rect" href="group__query__parse__edns__ext__ut.html#ga21eaeabf660d4d9f29291671a1cbd465" title=" " alt="" coords="683,25,825,51"/>
<area shape="poly" title=" " alt="" coords="867,56,825,50,826,45,868,51"/>
<area shape="rect" href="group__query.html#ga4387ff7b5e07e5b8249928c0bb1ac35b" title=" " alt="" coords="675,75,833,115"/>
<area shape="poly" title=" " alt="" coords="868,83,834,88,833,82,867,78"/>
<area shape="rect" href="group__query.html#gaa6dc55685778db382330d1e4ef70d3df" title=" " alt="" coords="524,83,627,108"/>
<area shape="poly" title=" " alt="" coords="661,98,627,98,627,93,661,93"/>
<area shape="rect" href="group__query__parse__ut.html#gaf477f506b934260a80c91285037b579b" title=" " alt="" coords="333,57,476,83"/>
<area shape="poly" title=" " alt="" coords="510,88,476,83,477,78,511,83"/>
<area shape="rect" href="vectorloop_8c.html#a2bb1129e00edf873d9eba6cb9b4517bf" title=" " alt="" coords="334,107,475,132"/>
<area shape="poly" title=" " alt="" coords="511,107,476,112,475,107,510,102"/>
<area shape="rect" href="group__vectorloop.html#ga8085b92988a2a04a741421ec75c785cd" title=" " alt="" coords="223,107,285,132"/>
<area shape="poly" title=" " alt="" coords="320,122,285,122,285,117,320,117"/>
<area shape="rect" href="group__ripples.html#ga3448cc4395fbd9b27bb229a87337067d" title=" " alt="" coords="108,107,175,132"/>
<area shape="poly" title=" " alt="" coords="209,122,175,122,175,117,209,117"/>
<area shape="rect" href="main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,107,60,132"/>
<area shape="poly" title=" " alt="" coords="94,122,60,122,60,117,94,117"/>
</map>
</div>

</div>
</div>
<a id="ga4387ff7b5e07e5b8249928c0bb1ac35b" name="ga4387ff7b5e07e5b8249928c0bb1ac35b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga4387ff7b5e07e5b8249928c0bb1ac35b">&#9670;&#160;</a></span>query_parse_request_rr_additional_edns()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int query_parse_request_rr_additional_edns </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__query.html#ga99fac2995915676a917f68a08bb7f007">query_t</a> *&#160;</td>
          <td class="paramname"><em>q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>ptr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Parse query request additional section looking for EDNS RR and if found parse EDNS RR.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">q</td><td>Query to parse request additional section EDNS opt RR. </td></tr>
    <tr><td class="paramname">ptr</td><td>Pointer in request buffer where additional section starts.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>On success returns number of bytes consumed. On error returns -1 in which case query parameter end_code is set. </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__query_ga4387ff7b5e07e5b8249928c0bb1ac35b_cgraph.png" border="0" usemap="#agroup__query_ga4387ff7b5e07e5b8249928c0bb1ac35b_cgraph" alt=""/></div>
<map name="agroup__query_ga4387ff7b5e07e5b8249928c0bb1ac35b_cgraph" id="agroup__query_ga4387ff7b5e07e5b8249928c0bb1ac35b_cgraph">
<area shape="rect" title=" " alt="" coords="5,23,164,63"/>
<area shape="rect" href="group__query.html#gaecf6360b330f2f7a882b4d0eca5d6da3" title=" " alt="" coords="212,5,380,31"/>
<area shape="poly" title=" " alt="" coords="164,31,198,27,199,32,165,36"/>
<area shape="rect" href="group__nsutils.html#ga9c3693281a90d416c4574dc690649be9" title=" " alt="" coords="217,55,375,80"/>
<area shape="poly" title=" " alt="" coords="165,50,204,54,203,59,164,55"/>
<area shape="rect" href="group__query.html#ga49ccb0e164ee4f981443c01bda0b7224" title=" " alt="" coords="428,5,617,31"/>
<area shape="poly" title=" " alt="" coords="380,15,414,15,414,21,380,21"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__query_ga4387ff7b5e07e5b8249928c0bb1ac35b_icgraph.png" border="0" usemap="#agroup__query_ga4387ff7b5e07e5b8249928c0bb1ac35b_icgraph" alt=""/></div>
<map name="agroup__query_ga4387ff7b5e07e5b8249928c0bb1ac35b_icgraph" id="agroup__query_ga4387ff7b5e07e5b8249928c0bb1ac35b_icgraph">
<area shape="rect" title=" " alt="" coords="675,23,833,63"/>
<area shape="rect" href="group__query.html#gaa6dc55685778db382330d1e4ef70d3df" title=" " alt="" coords="524,31,627,56"/>
<area shape="poly" title=" " alt="" coords="661,46,627,46,627,41,661,41"/>
<area shape="rect" href="group__query__parse__ut.html#gaf477f506b934260a80c91285037b579b" title=" " alt="" coords="333,5,476,31"/>
<area shape="poly" title=" " alt="" coords="510,36,476,31,477,26,511,31"/>
<area shape="rect" href="vectorloop_8c.html#a2bb1129e00edf873d9eba6cb9b4517bf" title=" " alt="" coords="334,55,475,80"/>
<area shape="poly" title=" " alt="" coords="511,55,476,60,475,55,510,50"/>
<area shape="rect" href="group__vectorloop.html#ga8085b92988a2a04a741421ec75c785cd" title=" " alt="" coords="223,55,285,80"/>
<area shape="poly" title=" " alt="" coords="320,70,285,70,285,65,320,65"/>
<area shape="rect" href="group__ripples.html#ga3448cc4395fbd9b27bb229a87337067d" title=" " alt="" coords="108,55,175,80"/>
<area shape="poly" title=" " alt="" coords="209,70,175,70,175,65,209,65"/>
<area shape="rect" href="main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,55,60,80"/>
<area shape="poly" title=" " alt="" coords="94,70,60,70,60,65,94,65"/>
</map>
</div>

</div>
</div>
<a id="ga0df26d3c47404b5de3f17d9b3d2a8468" name="ga0df26d3c47404b5de3f17d9b3d2a8468"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga0df26d3c47404b5de3f17d9b3d2a8468">&#9670;&#160;</a></span>query_parse_request_rr_question()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int query_parse_request_rr_question </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__query.html#ga99fac2995915676a917f68a08bb7f007">query_t</a> *&#160;</td>
          <td class="paramname"><em>q</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Parse query request question RR.</p>
<p>Format on the wire per RFC 1035 is:</p>
<p>0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 +&ndash;+&ndash;+&ndash;+&ndash;+&ndash;+&ndash;+&ndash;+&ndash;+&ndash;+&ndash;+&ndash;+&ndash;+&ndash;+&ndash;+&ndash;+&ndash;+ | | / QNAME / / / +&ndash;+&ndash;+&ndash;+&ndash;+&ndash;+&ndash;+&ndash;+&ndash;+&ndash;+&ndash;+&ndash;+&ndash;+&ndash;+&ndash;+&ndash;+&ndash;+ | QTYPE | +&ndash;+&ndash;+&ndash;+&ndash;+&ndash;+&ndash;+&ndash;+&ndash;+&ndash;+&ndash;+&ndash;+&ndash;+&ndash;+&ndash;+&ndash;+&ndash;+ | QCLASS | +&ndash;+&ndash;+&ndash;+&ndash;+&ndash;+&ndash;+&ndash;+&ndash;+&ndash;+&ndash;+&ndash;+&ndash;+&ndash;+&ndash;+&ndash;+&ndash;+</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">q</td><td>Query for which to parse request question.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>On success returns number of bytes from request buffer that are the question RR. On error returns -1 in which case query parameter end_code is set. </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__query_ga0df26d3c47404b5de3f17d9b3d2a8468_cgraph.png" border="0" usemap="#agroup__query_ga0df26d3c47404b5de3f17d9b3d2a8468_cgraph" alt=""/></div>
<map name="agroup__query_ga0df26d3c47404b5de3f17d9b3d2a8468_cgraph" id="agroup__query_ga0df26d3c47404b5de3f17d9b3d2a8468_cgraph">
<area shape="rect" title=" " alt="" coords="5,47,164,87"/>
<area shape="rect" href="group__nsutils.html#ga3fbc63b1755777c7c8e4dfbc34c038e6" title=" " alt="" coords="212,5,403,31"/>
<area shape="poly" title=" " alt="" coords="164,47,236,31,237,36,165,52"/>
<area shape="rect" href="group__nsutils.html#ga353a9e812c934fe3559c11340c0913ad" title=" " alt="" coords="214,55,401,80"/>
<area shape="poly" title=" " alt="" coords="164,65,200,65,200,70,164,70"/>
<area shape="rect" href="group__nsutils.html#gaa3975da9d09ac3fed8f402eb992927e2" title=" " alt="" coords="243,104,371,129"/>
<area shape="poly" title=" " alt="" coords="165,82,237,98,236,104,164,87"/>
<area shape="rect" href="group__nsutils.html#ga7af536be87c215ae9fef0a19d5e39fa4" title=" " alt="" coords="459,79,601,104"/>
<area shape="poly" title=" " alt="" coords="371,107,445,98,446,104,372,112"/>
<area shape="rect" href="group__nsutils.html#ga9c3693281a90d416c4574dc690649be9" title=" " alt="" coords="451,128,609,153"/>
<area shape="poly" title=" " alt="" coords="372,121,437,128,437,133,371,126"/>
<area shape="rect" href="rip__ns__utils_8c.html#af80ef420be17f5df8caa419b9182026e" title=" " alt="" coords="657,55,737,80"/>
<area shape="poly" title=" " alt="" coords="600,79,644,72,644,78,601,84"/>
<area shape="rect" href="rip__ns__utils_8c.html#aab66a853b32f5d595cf0121a3b9b87a3" title=" " alt="" coords="663,104,731,129"/>
<area shape="poly" title=" " alt="" coords="601,99,650,107,649,112,600,105"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__query_ga0df26d3c47404b5de3f17d9b3d2a8468_icgraph.png" border="0" usemap="#agroup__query_ga0df26d3c47404b5de3f17d9b3d2a8468_icgraph" alt=""/></div>
<map name="agroup__query_ga0df26d3c47404b5de3f17d9b3d2a8468_icgraph" id="agroup__query_ga0df26d3c47404b5de3f17d9b3d2a8468_icgraph">
<area shape="rect" title=" " alt="" coords="675,23,833,63"/>
<area shape="rect" href="group__query.html#gaa6dc55685778db382330d1e4ef70d3df" title=" " alt="" coords="524,31,627,56"/>
<area shape="poly" title=" " alt="" coords="661,46,627,46,627,41,661,41"/>
<area shape="rect" href="group__query__parse__ut.html#gaf477f506b934260a80c91285037b579b" title=" " alt="" coords="333,5,476,31"/>
<area shape="poly" title=" " alt="" coords="510,36,476,31,477,26,511,31"/>
<area shape="rect" href="vectorloop_8c.html#a2bb1129e00edf873d9eba6cb9b4517bf" title=" " alt="" coords="334,55,475,80"/>
<area shape="poly" title=" " alt="" coords="511,55,476,60,475,55,510,50"/>
<area shape="rect" href="group__vectorloop.html#ga8085b92988a2a04a741421ec75c785cd" title=" " alt="" coords="223,55,285,80"/>
<area shape="poly" title=" " alt="" coords="320,70,285,70,285,65,320,65"/>
<area shape="rect" href="group__ripples.html#ga3448cc4395fbd9b27bb229a87337067d" title=" " alt="" coords="108,55,175,80"/>
<area shape="poly" title=" " alt="" coords="209,70,175,70,175,65,209,65"/>
<area shape="rect" href="main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,55,60,80"/>
<area shape="poly" title=" " alt="" coords="94,70,60,70,60,65,94,65"/>
</map>
</div>

</div>
</div>
<a id="gaf0d829123d710a8c6890084265f714e7" name="gaf0d829123d710a8c6890084265f714e7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaf0d829123d710a8c6890084265f714e7">&#9670;&#160;</a></span>query_report_metrics()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void query_report_metrics </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__query.html#ga99fac2995915676a917f68a08bb7f007">query_t</a> *&#160;</td>
          <td class="paramname"><em>q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__metrics.html#ga343740345b0738f55592031789b23ac8">metrics_t</a> *&#160;</td>
          <td class="paramname"><em>metrics</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Report query metrics.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">q</td><td>Query to report metrics for. </td></tr>
    <tr><td class="paramname">metrics</td><td>Metrics object where to report metrics. </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__query_gaf0d829123d710a8c6890084265f714e7_icgraph.png" border="0" usemap="#agroup__query_gaf0d829123d710a8c6890084265f714e7_icgraph" alt=""/></div>
<map name="agroup__query_gaf0d829123d710a8c6890084265f714e7_icgraph" id="agroup__query_gaf0d829123d710a8c6890084265f714e7_icgraph">
<area shape="rect" title=" " alt="" coords="507,5,668,31"/>
<area shape="rect" href="vectorloop_8c.html#abfedd1f470befe2c8a6d5c8d029488d2" title=" " alt="" coords="333,5,459,31"/>
<area shape="poly" title=" " alt="" coords="493,21,459,21,459,15,493,15"/>
<area shape="rect" href="group__vectorloop.html#ga8085b92988a2a04a741421ec75c785cd" title=" " alt="" coords="223,5,285,31"/>
<area shape="poly" title=" " alt="" coords="320,21,286,21,286,15,320,15"/>
<area shape="rect" href="group__ripples.html#ga3448cc4395fbd9b27bb229a87337067d" title=" " alt="" coords="108,5,175,31"/>
<area shape="poly" title=" " alt="" coords="209,21,175,21,175,15,209,15"/>
<area shape="rect" href="main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,5,60,31"/>
<area shape="poly" title=" " alt="" coords="94,21,60,21,60,15,94,15"/>
</map>
</div>

</div>
</div>
<a id="ga779a2cedc67edf2bc0f83f5a886a57d8" name="ga779a2cedc67edf2bc0f83f5a886a57d8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga779a2cedc67edf2bc0f83f5a886a57d8">&#9670;&#160;</a></span>query_reset()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void query_reset </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__query.html#ga99fac2995915676a917f68a08bb7f007">query_t</a> *&#160;</td>
          <td class="paramname"><em>q</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Reset query object so it is suitable to be reused for new query processing.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">q</td><td>Query to reset. </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__query_ga779a2cedc67edf2bc0f83f5a886a57d8_icgraph.png" border="0" usemap="#agroup__query_ga779a2cedc67edf2bc0f83f5a886a57d8_icgraph" alt=""/></div>
<map name="agroup__query_ga779a2cedc67edf2bc0f83f5a886a57d8_icgraph" id="agroup__query_ga779a2cedc67edf2bc0f83f5a886a57d8_icgraph">
<area shape="rect" title=" " alt="" coords="729,55,828,80"/>
<area shape="rect" href="group__connection.html#ga7da801c674cefdee4cdfe1c601aa9077" title=" " alt="" coords="503,5,681,31"/>
<area shape="poly" title=" " alt="" coords="716,54,641,33,642,28,718,49"/>
<area shape="rect" href="group__query__object__ut.html#ga7944489e731194cda06c4ad068c1851d" title=" " alt="" coords="521,55,663,80"/>
<area shape="poly" title=" " alt="" coords="715,70,664,70,664,65,715,65"/>
<area shape="rect" href="vectorloop_8c.html#a3c705f68b8e44b7cb657d6772747d580" title=" " alt="" coords="335,80,453,105"/>
<area shape="poly" title=" " alt="" coords="726,86,682,95,621,101,560,103,453,100,453,94,560,97,621,95,681,90,725,81"/>
<area shape="rect" href="vectorloop_8c.html#ab3cec5e20125d98c83541557840c0dc9" title=" " alt="" coords="333,19,455,44"/>
<area shape="poly" title=" " alt="" coords="489,28,455,30,455,25,488,22"/>
<area shape="rect" href="group__vectorloop.html#ga8085b92988a2a04a741421ec75c785cd" title=" " alt="" coords="223,56,285,81"/>
<area shape="poly" title=" " alt="" coords="334,50,286,63,285,58,332,45"/>
<area shape="rect" href="group__ripples.html#ga3448cc4395fbd9b27bb229a87337067d" title=" " alt="" coords="108,56,175,81"/>
<area shape="poly" title=" " alt="" coords="209,71,175,71,175,66,209,66"/>
<area shape="rect" href="main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,56,60,81"/>
<area shape="poly" title=" " alt="" coords="94,71,60,71,60,66,94,66"/>
<area shape="poly" title=" " alt="" coords="321,83,285,77,286,71,322,78"/>
</map>
</div>

</div>
</div>
<a id="ga2170756867aab87d1d17a0c8388ae533" name="ga2170756867aab87d1d17a0c8388ae533"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga2170756867aab87d1d17a0c8388ae533">&#9670;&#160;</a></span>query_resolve()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void query_resolve </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__query.html#ga99fac2995915676a917f68a08bb7f007">query_t</a> *&#160;</td>
          <td class="paramname"><em>q</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Resolve a query and if appropriate pack the answer into response buffer.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">q</td><td>Query to resolve. </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__query_ga2170756867aab87d1d17a0c8388ae533_cgraph.png" border="0" usemap="#agroup__query_ga2170756867aab87d1d17a0c8388ae533_cgraph" alt=""/></div>
<map name="agroup__query_ga2170756867aab87d1d17a0c8388ae533_cgraph" id="agroup__query_ga2170756867aab87d1d17a0c8388ae533_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,120,31"/>
<area shape="rect" href="group__nsutils.html#gae88775d52f18a015532678abda660b0f" title=" " alt="" coords="168,5,309,31"/>
<area shape="poly" title=" " alt="" coords="120,15,154,15,154,21,120,21"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__query_ga2170756867aab87d1d17a0c8388ae533_icgraph.png" border="0" usemap="#agroup__query_ga2170756867aab87d1d17a0c8388ae533_icgraph" alt=""/></div>
<map name="agroup__query_ga2170756867aab87d1d17a0c8388ae533_icgraph" id="agroup__query_ga2170756867aab87d1d17a0c8388ae533_icgraph">
<area shape="rect" title=" " alt="" coords="535,5,649,31"/>
<area shape="rect" href="vectorloop_8c.html#a2358eac19906a9e59bae4b902647226c" title=" " alt="" coords="333,5,487,31"/>
<area shape="poly" title=" " alt="" coords="521,21,487,21,487,15,521,15"/>
<area shape="rect" href="group__vectorloop.html#ga8085b92988a2a04a741421ec75c785cd" title=" " alt="" coords="223,5,285,31"/>
<area shape="poly" title=" " alt="" coords="319,21,286,21,286,15,319,15"/>
<area shape="rect" href="group__ripples.html#ga3448cc4395fbd9b27bb229a87337067d" title=" " alt="" coords="108,5,175,31"/>
<area shape="poly" title=" " alt="" coords="209,21,175,21,175,15,209,15"/>
<area shape="rect" href="main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,5,60,31"/>
<area shape="poly" title=" " alt="" coords="94,21,60,21,60,15,94,15"/>
</map>
</div>

</div>
</div>
<a id="gac374ae1c30bca42b0cbd283a584c97eb" name="gac374ae1c30bca42b0cbd283a584c97eb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gac374ae1c30bca42b0cbd283a584c97eb">&#9670;&#160;</a></span>query_response_pack()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int query_response_pack </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__query.html#ga99fac2995915676a917f68a08bb7f007">query_t</a> *&#160;</td>
          <td class="paramname"><em>q</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Pack query response into query response buffer.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">q</td><td>Query to pack response for</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns 0 on success otherwise error occurred: -1 indicates that there was not enough room to pack full response and response is truncated. </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__query_gac374ae1c30bca42b0cbd283a584c97eb_cgraph.png" border="0" usemap="#agroup__query_gac374ae1c30bca42b0cbd283a584c97eb_cgraph" alt=""/></div>
<map name="agroup__query_gac374ae1c30bca42b0cbd283a584c97eb_cgraph" id="agroup__query_gac374ae1c30bca42b0cbd283a584c97eb_cgraph">
<area shape="rect" title=" " alt="" coords="5,55,168,80"/>
<area shape="rect" href="group__query.html#gadebe69962416277a46fe9908ceb29269" title=" " alt="" coords="216,5,351,31"/>
<area shape="poly" title=" " alt="" coords="137,52,218,31,220,37,139,57"/>
<area shape="rect" href="group__query.html#ga3e057ac872e708a9a49729628ca09051" title=" " alt="" coords="226,55,341,80"/>
<area shape="poly" title=" " alt="" coords="168,65,212,65,212,70,168,70"/>
<area shape="rect" href="group__nsutils.html#gac0f25e3df395a9651e46f3fa4c66866e" title=" " alt="" coords="231,104,336,129"/>
<area shape="poly" title=" " alt="" coords="139,77,220,98,218,103,137,83"/>
<area shape="rect" href="group__nsutils.html#ga28b1360ba956ef26eabf03fcda097032" title=" " alt="" coords="399,55,532,80"/>
<area shape="poly" title=" " alt="" coords="341,65,385,65,385,70,341,70"/>
<area shape="rect" href="group__nsutils.html#ga3ac967006e91ec4daf82046bbcd00edd" title=" " alt="" coords="580,29,723,55"/>
<area shape="poly" title=" " alt="" coords="532,56,566,51,567,56,533,61"/>
<area shape="rect" href="group__nsutils.html#gae88775d52f18a015532678abda660b0f" title=" " alt="" coords="581,79,722,104"/>
<area shape="poly" title=" " alt="" coords="533,73,567,78,567,83,532,79"/>
<area shape="rect" href="rip__ns__utils_8c.html#adf2f188c0488073e3df5497fcc6e4b35" title=" " alt="" coords="771,29,864,55"/>
<area shape="poly" title=" " alt="" coords="723,39,757,39,757,45,723,45"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__query_gac374ae1c30bca42b0cbd283a584c97eb_icgraph.png" border="0" usemap="#agroup__query_gac374ae1c30bca42b0cbd283a584c97eb_icgraph" alt=""/></div>
<map name="agroup__query_gac374ae1c30bca42b0cbd283a584c97eb_icgraph" id="agroup__query_gac374ae1c30bca42b0cbd283a584c97eb_icgraph">
<area shape="rect" title=" " alt="" coords="584,5,747,31"/>
<area shape="rect" href="vectorloop_8c.html#a992bdcae5a48e85fd09be95753553ab7" title=" " alt="" coords="333,5,536,31"/>
<area shape="poly" title=" " alt="" coords="570,21,536,21,536,15,570,15"/>
<area shape="rect" href="group__vectorloop.html#ga8085b92988a2a04a741421ec75c785cd" title=" " alt="" coords="223,5,285,31"/>
<area shape="poly" title=" " alt="" coords="319,21,286,21,286,15,319,15"/>
<area shape="rect" href="group__ripples.html#ga3448cc4395fbd9b27bb229a87337067d" title=" " alt="" coords="108,5,175,31"/>
<area shape="poly" title=" " alt="" coords="209,21,175,21,175,15,209,15"/>
<area shape="rect" href="main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,5,60,31"/>
<area shape="poly" title=" " alt="" coords="94,21,60,21,60,15,94,15"/>
</map>
</div>

</div>
</div>
<a id="ga4a05dc10da1dae3d26c01b40f1a6cf64" name="ga4a05dc10da1dae3d26c01b40f1a6cf64"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga4a05dc10da1dae3d26c01b40f1a6cf64">&#9670;&#160;</a></span>query_tcp_response_buffer_increase()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int query_tcp_response_buffer_increase </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__query.html#ga99fac2995915676a917f68a08bb7f007">query_t</a> *&#160;</td>
          <td class="paramname"><em>q</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Increase the query response buffer size. This is only valid if query is used with TCP transport.</p>
<p>Response buffer size is increased via call to realloc() in increments of <a class="el" href="group__nsutils.html#ga99122895c96f9b461d02f521469b5b1b">RIP_NS_UDP_MAXMSG</a> up to max size of <a class="el" href="group__nsutils.html#ga5c59367f2cd8ccdcdd35211c6b55c9aa">RIP_NS_MAXMSG</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">q</td><td>Query whose response buffer to increase.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns 0 on success, otherwise an error occurred and response buffer was untouched. </dd></dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__query_ga4a05dc10da1dae3d26c01b40f1a6cf64_icgraph.png" border="0" usemap="#agroup__query_ga4a05dc10da1dae3d26c01b40f1a6cf64_icgraph" alt=""/></div>
<map name="agroup__query_ga4a05dc10da1dae3d26c01b40f1a6cf64_icgraph" id="agroup__query_ga4a05dc10da1dae3d26c01b40f1a6cf64_icgraph">
<area shape="rect" title=" " alt="" coords="196,5,348,45"/>
<area shape="rect" href="group__query__object__ut.html#gadf13fe9eca3ea28fbbda3bcee4df08e5" title=" " alt="" coords="5,13,148,38"/>
<area shape="poly" title=" " alt="" coords="182,28,148,28,148,23,182,23"/>
</map>
</div>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
